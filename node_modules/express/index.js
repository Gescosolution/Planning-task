/*!
 * express
 * Copyright(c) 2009-2013 TJ Holowaychuk
 * Copyright(c) 2013 Roman Shtylman
 * Copyright(c) 2014-2015 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict';

module.exports = require('./lib/express');

var express = require('express');
var app = express(); //Creación objeto express;
//var birds = require('./birds');

app.set('view engine','jade');

//Creacion de la vista
app.get('/indice/',function(req,res){
	res.render('index',{title:'Hey', message:'Hello there!'})
});


app.get('/example/a', function ( req, res ){
	res.send("hello world A");
});

app.get('/example/b',function (req, res, next){
	console.log('La respuesta será enviada a la siguiente función');
	next();
}, function(req, res){
	res.send('hello from B');	
});

/* Manejador de rutas mediante una combinación de funciones */

var cb0 = app.get('/example/c', function ( req, res, next){
	console.log("CB0");
	next();
});

var cb1 = app.get('/example/c', function ( req, res, next){
	console.log("CB1");
	next();
}); 

var cb2 = app.get('/example/c', function ( req, res, next){
	res.send("Hello from C");
}); 

app.get('/example/c', [cb1,cb0,cb2]);

/* Rutas encadenadas */
app.route('/book')
	.get(function(req,res){
		res.send('Get my book');
	})
	.post(function(req,res){
		res.send('Post my book');
	})
	.put(function(req,res){
		res.send('Put my book');
	});
	
/*Creacion de middleware*/
var myLogger = function(req, res, next){
	console.log('LOGGED');
	next();
};

app.use(myLogger);

/* Mandar un hello world al raíz del sistema */
app.get('/example',function(req, res){
	res.send('Hello World!');	
});
//Utiliza birds

//app.use('/birds',birds);

/*Preparando el escuchador del servidor con su port y su host */
var server = app.listen(3000,function(){
	var host = server.address().address;
	var port = server.address().port;	
	
	console.log('Example app listening at http://%s %s',host,port);
});
